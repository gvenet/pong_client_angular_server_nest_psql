<div class="lobby-container">
  <header class="lobby-header">
    <h1>ğŸ“ Pong Online - Lobby</h1>
    <div class="user-info">
      <span>Bienvenue, <strong>{{ username }}</strong></span>
      <button class="btn-admin" (click)="goToAdmin()" *ngIf="isAdmin()">ğŸ›¡ï¸ Admin</button>
      <button class="btn-logout" (click)="logout()">DÃ©connexion</button>
    </div>
  </header>

  <div class="lobby-content">
    <div class="content-grid">
      <!-- Section des parties -->
      <div class="games-section">
        <div class="action-bar">
          <button
            class="btn-new-game"
            (click)="newGame()"
            [disabled]="loading">
            {{ loading ? 'Chargement...' : 'ğŸ® Commencer Ã  jouer' }}
          </button>
          <button
            class="btn-refresh"
            (click)="loadGames()"
            [disabled]="loading">
            ğŸ”„ RafraÃ®chir
          </button>
        </div>

        <div class="error-message" *ngIf="error">
          {{ error }}
        </div>

        <h2>Parties actives ({{ games.length }})</h2>

        <div class="games-container" *ngIf="games.length > 0">
          <div
            class="game-card"
            *ngFor="let game of games"
            [class.clickable]="canJoinGame(game) || canWatchGame(game) || isMyGame(game)"
            [class.my-game]="isMyGame(game)"
            [class.watchable]="canWatchGame(game)"
            (click)="handleGameCardClick(game)">

            <div class="game-header">
              <span class="game-id">{{ game.id }}</span>
              <div class="header-right">
                <span class="my-game-badge" *ngIf="isMyGame(game)">Votre partie</span>
                <span
                  class="game-status"
                  [ngClass]="getStatusClass(game.status)">
                  {{ getStatusText(game.status) }}
                </span>
              </div>
            </div>

            <div class="game-players">
              <div class="player">
                <span class="player-icon">ğŸ‘¤</span>
                <span class="player-name">{{ game.player1.username }}</span>
                <span class="player-score">{{ game.score1 }}</span>
              </div>

              <div class="vs">VS</div>

              <div class="player" *ngIf="game.player2; else waitingPlayer">
                <span class="player-icon">ğŸ‘¤</span>
                <span class="player-name">{{ game.player2.username }}</span>
                <span class="player-score">{{ game.score2 }}</span>
              </div>

              <ng-template #waitingPlayer>
                <div class="player waiting">
                  <span class="player-icon">â“</span>
                  <span class="player-name">En attente...</span>
                  <span class="player-score">0</span>
                </div>
              </ng-template>
            </div>

            <div class="game-info">
              <small>CrÃ©Ã©e il y a {{ getTimeSince(game.createdAt) }}</small>
            </div>
          </div>
        </div>

        <div class="empty-state" *ngIf="games.length === 0 && !loading">
          <p>ğŸ® Aucune partie active</p>
          <p>Cliquez sur "Commencer Ã  jouer" pour lancer une partie !</p>
        </div>

        <div class="loading-state" *ngIf="loading && games.length === 0">
          <p>Chargement des parties...</p>
        </div>
      </div>

      <!-- Section du chat -->
      <div class="chat-section">
        <app-chat></app-chat>
      </div>
    </div>
  </div>
</div>